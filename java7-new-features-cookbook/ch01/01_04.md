### 使用try-with-resources块改进异常处理代码

在Java 7以前，代码需要正确地打开和关闭资源，比如*java.io.InputStream*和*java.nio.Channel*，不仅代码繁琐并且容易出错。*try-with-resources*被加进来力图简化错误处理及简化代码。使用*try-with-resources*语句，资源会被自动关闭。使用*try-with-resources*声明的资源必须实现接口* java.lang.AutoCloseable*。

这个方式不仅会促使一个好的代码风格，并且可以避免嵌套、过度的*try-catch*块，同时它也确保了精确的资源管理，关于这方面可以参考有关**自动资源管理Automated Resource Management (ARM)**的学术讨论。

#### 准备

需要打开和关闭资源时，如下使用*try-with-resources*块：

* 创建try块并声明需要受管的资源
* 在try块里使用资源

#### 动手

1、创建一个控制台程序，在它里面添加如下的*main*方法。在工作目录下创建一个文本文件*users.txt*，在它里面添加一串名字。程序打开文件，创建一个备份，在这个过程中会在*try*块里创建一个* java.io.BufferedReader*和*java.io.BufferedWriter*，以此来演示*try-with-resources*的使用：

```java
    public static void main(String[] args) {

        try (BufferedReader inputReader = Files.newBufferedReader(Paths.get(new URI("file:///f:/users.txt")), Charset.defaultCharset());
                BufferedWriter outputWriter = Files.newBufferedWriter(Paths.get(new URI("file:///f:/users.bak")), Charset.defaultCharset());) {

            String inputLine = null;
            while ((inputLine = inputReader.readLine()) != null) {
                outputWriter.write(inputLine);
                outputWriter.newLine();
            }
            System.out.println("Copy complete!");
        } catch (URISyntaxException | IOException e) {
            e.printStackTrace();
        }
    }
```

2、执行程序，输出如下:

    Copy complete!

#### 原理

